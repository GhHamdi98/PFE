{% extends 'base.html.twig' %}

{% block title %}Liste des utilisateurs{% endblock %}
{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('plugins/sweetalert2-theme-bootstrap-4/bootstrap-4.min.css') }}">
    <!-- Toastr -->
    <link rel="stylesheet" href="{{ asset('plugins/toastr/toastr.min.css') }}">
    <link rel="apple-touch-icon" sizes="76x76" href="{{ asset('demande/assets/img/apple-icon.png') }}" />
    <link rel="icon" type="image/png" href="{{ asset('demande/assets/img/favicon.png') }}" />
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Liste des utilisateurs</title>
    <!-- Tell the browser to be responsive to screen width -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="{{ asset('plugins/sweetalert2-theme-bootstrap-4/bootstrap-4.min.css') }}">
    <!-- Toastr -->
    <link rel="stylesheet" href="{{ asset('plugins/toastr/toastr.min.css') }}">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="{{ asset('plugins/fontawesome-free/css/all.min.css') }}">
    <!-- Ionicons -->
    <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <!-- DataTables -->
    <!-- Theme style -->
    <link rel="stylesheet" href="{{ asset('dist/css/adminlte.min.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ asset('plugins/datatables-bs4/css/dataTables.bootstrap4.css') }}"/>
    <!-- Google Font: Source Sans Pro -->
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700" rel="stylesheet">
    <style>
        .loading{
            color: black;
            font-size: 90px;
            text-indent: -9999em;
            overflow: hidden;
            width: 1em;
            height: 1em;
            border-radius: 50%;
            margin: 72px auto;
            position: fixed;
            top: 10px;
            left: 0;
            bottom: 0;
            right: 0;
            -webkit-transform: translateZ(0);
            -ms-transform: translateZ(0);
            transform: translateZ(0);
            -webkit-animation: load6 1.7s infinite ease, round 1.7s infinite ease;
            animation: load6 1.7s infinite ease, round 1.7s infinite ease;
        }
        @-webkit-keyframes load6 {
            0% {
                box-shadow: 0 -0.83em 0 -0.4em, 0 -0.83em 0 -0.42em, 0 -0.83em 0 -0.44em, 0 -0.83em 0 -0.46em, 0 -0.83em 0 -0.477em;
            }
            5%,
            95% {
                box-shadow: 0 -0.83em 0 -0.4em, 0 -0.83em 0 -0.42em, 0 -0.83em 0 -0.44em, 0 -0.83em 0 -0.46em, 0 -0.83em 0 -0.477em;
            }
            10%,
            59% {
                box-shadow: 0 -0.83em 0 -0.4em, -0.087em -0.825em 0 -0.42em, -0.173em -0.812em 0 -0.44em, -0.256em -0.789em 0 -0.46em, -0.297em -0.775em 0 -0.477em;
            }
            20% {
                box-shadow: 0 -0.83em 0 -0.4em, -0.338em -0.758em 0 -0.42em, -0.555em -0.617em 0 -0.44em, -0.671em -0.488em 0 -0.46em, -0.749em -0.34em 0 -0.477em;
            }
            38% {
                box-shadow: 0 -0.83em 0 -0.4em, -0.377em -0.74em 0 -0.42em, -0.645em -0.522em 0 -0.44em, -0.775em -0.297em 0 -0.46em, -0.82em -0.09em 0 -0.477em;
            }
            100% {
                box-shadow: 0 -0.83em 0 -0.4em, 0 -0.83em 0 -0.42em, 0 -0.83em 0 -0.44em, 0 -0.83em 0 -0.46em, 0 -0.83em 0 -0.477em;
            }
        }
        @keyframes load6 {
            0% {
                box-shadow: 0 -0.83em 0 -0.4em, 0 -0.83em 0 -0.42em, 0 -0.83em 0 -0.44em, 0 -0.83em 0 -0.46em, 0 -0.83em 0 -0.477em;
            }
            5%,
            95% {
                box-shadow: 0 -0.83em 0 -0.4em, 0 -0.83em 0 -0.42em, 0 -0.83em 0 -0.44em, 0 -0.83em 0 -0.46em, 0 -0.83em 0 -0.477em;
            }
            10%,
            59% {
                box-shadow: 0 -0.83em 0 -0.4em, -0.087em -0.825em 0 -0.42em, -0.173em -0.812em 0 -0.44em, -0.256em -0.789em 0 -0.46em, -0.297em -0.775em 0 -0.477em;
            }
            20% {
                box-shadow: 0 -0.83em 0 -0.4em, -0.338em -0.758em 0 -0.42em, -0.555em -0.617em 0 -0.44em, -0.671em -0.488em 0 -0.46em, -0.749em -0.34em 0 -0.477em;
            }
            38% {
                box-shadow: 0 -0.83em 0 -0.4em, -0.377em -0.74em 0 -0.42em, -0.645em -0.522em 0 -0.44em, -0.775em -0.297em 0 -0.46em, -0.82em -0.09em 0 -0.477em;
            }
            100% {
                box-shadow: 0 -0.83em 0 -0.4em, 0 -0.83em 0 -0.42em, 0 -0.83em 0 -0.44em, 0 -0.83em 0 -0.46em, 0 -0.83em 0 -0.477em;
            }
        }
        @-webkit-keyframes round {
            0% {
                -webkit-transform: rotate(0deg);
                transform: rotate(0deg);
            }
            100% {
                -webkit-transform: rotate(360deg);
                transform: rotate(360deg);
            }
        }
        @keyframes round {
            0% {
                -webkit-transform: rotate(0deg);
                transform: rotate(0deg);
            }
            100% {
                -webkit-transform: rotate(360deg);
                transform: rotate(360deg);
            }
        }

    </style>
{% endblock %}
{% block body %}
    <script>
        document.addEventListener("DOMContentLoaded", function(event) {
            $.ajax({
                method: "POST",
                url: "{{ path('user_connected', {'id': app.user.id}) }}",
                data: {idUser: $("#idUser").val() },
                success: function(data) {
                    console.log(data);
                }
            })
        });
    </script>
    <div class="wrapper">
        <!-- Navbar -->
        <nav class="main-header navbar navbar-expand navbar-white navbar-light">
            <!-- Left navbar links -->
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" data-widget="pushmenu" href="#"><i class="fas fa-bars"></i></a>
                </li>

            </ul>

            <!-- Right navbar links -->
            <ul class="navbar-nav ml-auto">
                <!-- Messages Dropdown Menu -->
                <li class="nav-item dropdown">
                    <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right">
                        <div class="dropdown-divider"></div>
                        <div class="dropdown-divider"></div>
                            </div>
                            <!-- Message End -->

                </li>
                <!-- Notifications Dropdown Menu -->
                <li class="nav-item dropdown">
                </li>
                <li class="nav-item">
                    <a href="{{ path('user_disconnected',{'id' :app.user.id}) }}"><img title="Se déconnecter" src="https://img.icons8.com/color/28/000000/export.png"/></a>
                </li>
                <input id="idUser" type="hidden" value="{{ app.user.id }}">
            </ul>
        </nav>
        <!-- /.navbar -->

        <!-- Main Sidebar Container -->
        <aside class="main-sidebar sidebar-dark-primary elevation-4">
            <!-- Brand Logo -->
            <a href="/user" class="brand-link">
                <img src="{{ asset('dist/img/AdminLTELogo.png') }}"
                     alt="AdminLTE Logo"
                     class="brand-image img-circle elevation-3"
                     style="opacity: .8">
                <span class="brand-text font-weight-light">Quote Request</span>
            </a>

            <!-- Sidebar -->
            <div class="sidebar">
                <!-- Sidebar user (optional) -->
                <div class="user-panel mt-3 pb-3 mb-3 d-flex">
                    <div class="image">
                        <img src="https://img.icons8.com/bubbles/30/000000/admin-settings-male.png"/>
                    </div>
                    <div class="info">
                        <a href="{{ path('user_show', {'id': app.user.id}) }}" class="d-block">{{app.user.username}}</a>
                    </div>
                </div>

                <!-- Sidebar Menu -->
                <nav class="mt-2">
                    <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
                        <!-- Add icons to the links using the .nav-icon class
                             with font-awesome or any other icon font library -->
                        <li class="nav-item has-treeview menu-open active">
                            <a href="#" class="nav-link active">
                                <i><img src="{{ asset('dist/img/group.png') }}"></i>
                                <p>
                                    Utilisateurs
                                    <i class="right fas fa-angle-left"></i>
                                </p>
                            </a>
                            <ul class="nav nav-treeview">
                                <li class="nav-item ">
                                    <a href="/user" class="nav-link active">
                                        <i class="far fa-circle nav-icon"></i>
                                        <p>&nbsp; Liste des Utilisateur</p>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="/user/new" class="nav-link ">
                                        <i class="far fa-circle nav-icon"></i>
                                        <p>Ajouter Utilisateur</p>
                                    </a>
                                </li>
                            </ul>
                        </li>
                        <li class="nav-item has-treeview ">
                            <a href="#" class="nav-link ">
                                <i><img src="{{ asset('img/demande.png.png') }}"></i>                                <p>
                                    Demande
                                    <i class="fas fa-angle-left right"></i>
                                </p>
                            </a>
                            <ul class="nav nav-treeview ">
                                <li class="nav-item ">
                                    <a href="/demande" class="nav-link ">
                                        <i class="far fa-circle nav-icon"></i>                                <p>
                                        <p>Liste des Demandes</p>
                                    </a>
                                </li>
                            </ul>
                        </li>
                        <li class="nav-item has-treeview ">
                            <a href="#" class="nav-link ">
                                <i><img src="{{ asset('img/service.png') }}"></i>                                <p>
                                    Service
                                    <i class="fas fa-angle-left right"></i>
                                </p>
                            </a>
                            <ul class="nav nav-treeview ">
                                <li class="nav-item ">
                                    <a href="/service" class="nav-link ">
                                        <i><i class="far fa-circle nav-icon"></i></i>                                <p>
                                        <p>Liste des Service</p>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="/service/new" class="nav-link">
                                        <i><i class="far fa-circle nav-icon"></i></i>                                <p>
                                        <p>Ajouter Service</p>
                                    </a>
                                </li>
                                <li class="nav-item">

                                <li class="nav-item has-treeview ">
                                    <a href="#" class="nav-link ">
                                        <i><img src="{{ asset('img/pays.png') }}"></i>                                <p>
                                            Pays
                                            <i class="fas fa-angle-left right"></i>
                                        </p>
                                    </a>
                                    <ul class="nav nav-treeview ">
                                        <li class="nav-item ">
                                            <a href="/pays" class="nav-link ">
                                                &nbsp;&nbsp;&nbsp;<i class="far fa-circle nav-icon"></i>                                <p>
                                                <p>Liste des Pays</p>
                                            </a>
                                        </li>
                                        <li class="nav-item">
                                            <a href="/pays/new" class="nav-link">
                                                &nbsp;&nbsp;&nbsp;<i class="far fa-circle nav-icon"></i>                               <p>
                                                <p>Ajouter Pays</p>
                                            </a>
                                        </li>
                                    </ul>
                                </li>
                                </li>
                            </ul>
                        <li class="nav-item has-treeview ">
                            <a href="#" class="nav-link ">
                                <i><img src="https://img.icons8.com/windows/24/000000/user-settings.png"></i>                                <p>
                                    Compte
                                    <i class="fas fa-angle-left right"></i>
                                </p>
                            </a>
                            <ul class="nav nav-treeview ">
                                <li class="nav-item ">
                                    <a href="{{ path('user_Accountedit', {'id': app.user.id}) }}" class="nav-link ">
                                        &nbsp;&nbsp;&nbsp;<i class="far fa-circle nav-icon"></i>                                <p>
                                        <p>Gérer compte</p>
                                    </a>
                                </li>
                                </li>
                            </ul>
                        </li>
                        <li class="nav-item has-treeview">
                            <a href="#" class="nav-link">
                                <i><img src="https://img.icons8.com/ios/26/000000/composing-mail.png"></i>
                                <p>
                                    Mail
                                    <i class="right fas fa-angle-left"></i>
                                </p>
                            </a>
                            <ul class="nav nav-treeview">
                                <li class="nav-item ">
                                    <a href="{{ path('mail_index') }}" class="nav-link ">
                                        <i class="far fa-circle nav-icon"></i>
                                        <p>&nbsp; Liste des Mails</p>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="{{ path('mail_new') }}" class="nav-link ">
                                        <i class="far fa-circle nav-icon"></i>
                                        <p>Ajouter mail</p>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="{{ path('send_mails') }}" class="nav-link ">
                                        <i class="far fa-circle nav-icon"></i>
                                        <p>Envoyer mail</p>
                                    </a>
                                </li>
                            </ul>
                        </li>
                </nav>
                <!-- /.sidebar-menu -->
            </div>
            <!-- /.sidebar -->
        </aside>

        <!-- Content Wrapper. Contains page content -->
        <div class="content-wrapper">
            <!-- Content Header (Page header) -->
            <section class="content-header">
                <div class="container-fluid">
                    <div class="row mb-2">
                        <div class="col-sm-6">
                        </div>
                        <div class="col-sm-6">
                        </div>
                    </div>
                </div><!-- /.container-fluid -->
            </section>

            <!-- Main content -->
            <section class="content">
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card card-primary card-tabs">
                                <div class="card-header p-0 pt-1">
                                    <ul class="nav nav-tabs" id="custom-tabs-one-tab" role="tablist">
                                        <li class="nav-item">
                                            <a class="nav-link active" id="custom-tabs-one-home-tab" data-toggle="pill" href="#custom-tabs-one-home" role="tab" aria-controls="custom-tabs-one-home" aria-selected="true">Tous utilisateurs</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" id="custom-tabs-one-profile-tab" data-toggle="pill" href="#custom-tabs-one-profile" role="tab" aria-controls="custom-tabs-one-profile" aria-selected="false">Partenaires</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" id="custom-tabs-one-messages-tab" data-toggle="pill" href="#custom-tabs-one-messages" role="tab" aria-controls="custom-tabs-one-messages" aria-selected="false">Commerciaux</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" id="custom-tabs-one-settings-tab" data-toggle="pill" href="#custom-tabs-one-settings" role="tab" aria-controls="custom-tabs-one-settings" aria-selected="false">Prospects</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="card-body">
                                    <div class="tab-content" id="custom-tabs-one-tabContent">
                                        <div class="tab-pane fade show active" id="custom-tabs-one-home" role="tabpanel" aria-labelledby="custom-tabs-one-home-tab">
                                            <div id="ajax" class="card-body">
                                                <table id="example1" class="table table-bordered table-hover">
                                                    <thead>
                                                    <tr>
                                                        <th>&nbsp;&nbsp;ID</th>
                                                        <th>&nbsp;&nbsp;Nom D'utilisateur</th>
                                                        <th>&nbsp;&nbsp;Derniere Visite</th>
                                                        <th>&nbsp;&nbsp;Email</th>
                                                        {% if role =='commerciale' %}
                                                            <th>Affecté a</th>
                                                        {% endif %}
                                                        <th>&nbsp;&nbsp;Connecté(e)</th>
                                                        <th>&nbsp;&nbsp;Voir/Editer</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody id="div">
                                                    {% for user in users %}
                                                        <tr>
                                                            <td>&nbsp;&nbsp;{{ user.id }}</td>
                                                            <td>&nbsp;&nbsp;{{ user.userName }}</td>
                                                            <td>
                                                                {% if user.LastLogin == null %}
                                                                    <span class="alert-default-warning">N'a pas encore visité!</span>
                                                                {% else %}
                                                                    {{ user.LastLogin ? user.LastLogin|date('Y-m-d H:i:s')   }}
                                                                {% endif %}
                                                            </td>
                                                            <td>{{ user.Email }}</td>
                                                            <script>var i=0;</script>
                                                            {% if role =='commerciale' %}
                                                                <td>
                                                                    {{ user.level }}
                                                                    <span id='affectation ' class="btn-outline-primary">Affectation</span>
                                                                </td>
                                                                <script>i++;</script>
                                                            {% endif %}
                                                            <td>{% if(user.Connecte==true) %}
                                                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="{{ asset('dist/img/on.png') }}"></i>
                                                                {% else %}
                                                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="{{ asset('dist/img/off.png') }}"></i>
                                                                {% endif %}
                                                            </td>
                                                            <td>
                                                                &nbsp;&nbsp;<a href="{{ path('user_show', {'id': user.id}) }}"><i class="fas fa-eye"></i></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                                                <a href="{{ path('user_edit', {'id': user.id}) }}"><i class="fas fa-edit"></i></a>
                                                            </td>
                                                        </tr>
                                                    {% else %}
                                                        <tr>
                                                            <td colspan="10" style="text-align: center" class="alert-default-warning">Aucun utilisateur trouvé</td>
                                                        </tr>
                                                    {% endfor %}
                                                    </tbody>
                                                    <tfoot>
                                                    <tr>
                                                        <th>&nbsp;&nbsp;ID</th>
                                                        <th>&nbsp;&nbsp;Nom D'utilisateur</th>
                                                        <th>&nbsp;&nbsp;Derniere Visite</th>
                                                        <th>&nbsp;&nbsp;Email</th>
                                                        {% if role =='commerciale' %}
                                                            <th>Affecté a</th>
                                                        {% endif %}
                                                        <th>&nbsp;&nbsp;Connecté(e)</th>
                                                        <th>&nbsp;&nbsp;Voir/Editer</th>
                                                    </tr>
                                                    </tfoot>
                                                </table>
                                                <br>
                                                <a href="{{ path('user_new') }}">Creer utilisateur</a>
                                            </div>                                        </div>
                                        <div class="tab-pane fade" id="custom-tabs-one-profile" role="tabpanel" aria-labelledby="custom-tabs-one-profile-tab">
                                            <div id="ajax" class="card-body">
                                                <table id="example11" class="table table-bordered table-hover">
                                                    <thead>
                                                    <tr>
                                                        <th>&nbsp;&nbsp;ID</th>
                                                        <th>&nbsp;&nbsp;Nom D'utilisateur</th>
                                                        <th>&nbsp;&nbsp;Derniere Visite</th>
                                                        <th>&nbsp;&nbsp;Email</th>
                                                        {% if role =='commerciale' %}
                                                            <th>Affecté a</th>
                                                        {% endif %}
                                                        <th>&nbsp;&nbsp;Connecté(e)</th>
                                                        <th>&nbsp;&nbsp;Voir/Editer</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody id="div">
                                                    {% set iii=0 %}
                                                    {% for user in part %}
                                                        <tr>
                                                            <td>&nbsp;&nbsp;{{ user.id }}</td>
                                                            <input id="id{{ iii }}" type="hidden" value="{{ user.id }}">
                                                            <input id="nom{{iii }}" type="hidden" value="{{ user.userName }}">
                                                            <td>&nbsp;&nbsp;{{ user.userName }}</td>
                                                            <td>
                                                                {% if user.LastLogin == null %}
                                                                    <span class="alert-default-warning">N'a pas encore visité!</span>
                                                                {% else %}
                                                                    {{ user.LastLogin ? user.LastLogin|date('Y-m-d H:i:s')   }}
                                                                {% endif %}
                                                            </td>
                                                            <td>{{ user.Email }}</td>
                                                            <script>var i=0;</script>
                                                            {% if role =='commerciale' %}
                                                                <td>
                                                                    {{ user.level }}<br>
                                                                    &nbsp;&nbsp;<span id='affectation ' class="btn-outline-primary">Affectation</span>
                                                                </td>
                                                                <script>i++;</script>
                                                            {% endif %}
                                                            <td>{% if(user.Connecte==1) %}
                                                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="{{ asset('dist/img/on.png') }}"></i>
                                                                {% else %}
                                                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="{{ asset('dist/img/off.png') }}"></i>
                                                                {% endif %}
                                                            </td>
                                                            <td>
                                                                &nbsp;&nbsp;<a href="{{ path('user_show', {'id': user.id}) }}"><i class="fas fa-eye"></i></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                                                <a href="{{ path('user_edit', {'id': user.id}) }}"><i class="fas fa-edit"></i></a>
                                                            </td>
                                                        </tr>
                                                        {% set iii=iii+1 %}
                                                        {% else %}
                                                        <tr>
                                                            <td colspan="10" style="text-align: center" class="alert-default-warning">Aucun utilisateur trouvé</td>
                                                        </tr>
                                                    {% endfor %}
                                                    </tbody>
                                                    <tfoot>
                                                    <tr>
                                                        <th>&nbsp;&nbsp;ID</th>
                                                        <th>&nbsp;&nbsp;Nom D'utilisateur</th>
                                                        <th>&nbsp;&nbsp;Derniere Visite</th>
                                                        <th>&nbsp;&nbsp;Email</th>
                                                        {% if role =='commerciale' %}
                                                            <th>Affecté a</th>
                                                        {% endif %}
                                                        <th>&nbsp;&nbsp;Connecté(e)</th>
                                                        <th>&nbsp;&nbsp;Voir/Editer</th>
                                                    </tr>
                                                    </tfoot>
                                                </table>
                                                <br>
                                                <a href="{{ path('user_new') }}">Creer utilisateur</a>
                                            </div>
                                        </div>
                                        <div class="tab-pane fade" id="custom-tabs-one-messages" role="tabpanel" aria-labelledby="custom-tabs-one-messages-tab">
                                            <div id="ajax" class="card-body">
                                                <table id="example12" class="table table-bordered table-hover">
                                                    <thead>
                                                    <tr>
                                                        <th>&nbsp;&nbsp;ID</th>
                                                        <th>&nbsp;&nbsp;Nom D'utilisateur</th>
                                                        <th>&nbsp;&nbsp;Affecté à</th>

                                                        <th>&nbsp;&nbsp;Derniere Visite</th>
                                                        <th>&nbsp;&nbsp;Email</th>
                                                        {% if role =='commerciale' %}
                                                            <th>Affecté a</th>
                                                        {% endif %}
                                                        <th>&nbsp;&nbsp;Connecté(e)</th>
                                                        <th>&nbsp;&nbsp;Voir/Editer</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody id="div">
                                                    {% set iiii=0%}
                                                    {% for user in comm %}
                                                        <tr>
                                                            <td >&nbsp;&nbsp;{{ user.id }}<input id="ids{{ iiii }}" type="hidden" value="{{ user.id }}"></td>
                                                            <td>&nbsp;&nbsp;{{ user.userName }}</td>
                                                            <td id="prenom{{ iiii }}" class="level{{ iiii }}">&nbsp;&nbsp;{{ user.level }}
                                                                    <button id="" class=" affect{{ iiii }} btn btn-success" onclick="app({{ iiii }})">Affectation</button>
                                                                {% set iiii=iiii+1 %}
                                                            </td>
                                                            <td>
                                                                {% if user.LastLogin == null %}
                                                                    <span class="alert-default-warning">N'a pas encore visité!</span>
                                                                {% else %}
                                                                    {{ user.LastLogin ? user.LastLogin|date('Y-m-d H:i:s')   }}
                                                                {% endif %}
                                                            </td>
                                                            <td>{{ user.Email }}
                                                            </td>
                                                            <script>var i=0;</script>
                                                            {% if role =='commerciale' %}
                                                                <td>
                                                                    {{ user.level }}
                                                                    <span id='affectation ' class="btn-outline-primary">Affectation</span>
                                                                </td>
                                                                <script>i++;</script>
                                                            {% endif %}
                                                            <td>{% if(user.Connecte==true) %}
                                                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="{{ asset('dist/img/on.png') }}"></i>
                                                                {% else %}
                                                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="{{ asset('dist/img/off.png') }}"></i>
                                                                {% endif %}
                                                            </td>
                                                            <td>
                                                                &nbsp;&nbsp;<a href="{{ path('user_show', {'id': user.id}) }}"><i class="fas fa-eye"></i></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                                                <a href="{{ path('user_edit', {'id': user.id}) }}"><i class="fas fa-edit"></i></a>
                                                            </td>
                                                        </tr>
                                                    {% else %}
                                                        <tr>
                                                            <td colspan="10" style="text-align: center" class="alert-default-warning">Aucun utilisateur trouvé</td>
                                                        </tr>
                                                    {% endfor %}

                                                    </tbody>
                                                    <tfoot>
                                                    <tr>
                                                        <th>&nbsp;&nbsp;ID</th>
                                                        <th>&nbsp;&nbsp;Nom D'utilisateur</th>
                                                        <th>&nbsp;&nbsp;Affecté à</th>
                                                        <th>&nbsp;&nbsp;Derniere Visite</th>
                                                        <th>&nbsp;&nbsp;Email</th>
                                                        {% if role =='commerciale' %}
                                                            <th>Affecté a</th>
                                                        {% endif %}
                                                        <th>&nbsp;&nbsp;Connecté(e)</th>
                                                        <th>&nbsp;&nbsp;Voir/Editer</th>
                                                    </tr>
                                                    </tfoot>
                                                </table>
                                                <br>
                                                <a href="{{ path('user_new') }}">Creer utilisateur</a>
                                            </div>     </div>
                                        <div class="tab-pane fade" id="custom-tabs-one-settings" role="tabpanel" aria-labelledby="custom-tabs-one-profile-tab">
                                            <div id="ajax" class="card-body">
                                                <table id="example9" class="table table-bordered table-hover">
                                                    <thead>
                                                    <tr>
                                                        <th>&nbsp;&nbsp;ID</th>
                                                        <th>&nbsp;&nbsp;Nom D'utilisateur</th>
                                                        <th>&nbsp;&nbsp;Derniere Visite</th>
                                                        <th>&nbsp;&nbsp;Email</th>
                                                        {% if role =='commerciale' %}
                                                            <th>Affecté a</th>
                                                        {% endif %}
                                                        <th>&nbsp;&nbsp;Connecté(e)</th>
                                                        <th>&nbsp;&nbsp;Voir/Editer</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody id="div">
                                                    {% for user in prosp %}
                                                        <tr>
                                                            <td>&nbsp;&nbsp;{{ user.id }}</td>
                                                            <td>&nbsp;&nbsp;{{ user.userName }}</td>
                                                            <td>
                                                                {% if user.LastLogin == null %}
                                                                    <span class="alert-default-warning">N'a pas encore visité!</span>
                                                                {% else %}
                                                                    {{ user.LastLogin ? user.LastLogin|date('Y-m-d H:i:s')   }}
                                                                {% endif %}
                                                            </td>
                                                            <td>{{ user.Email }}</td>
                                                            <script>var i=0;</script>
                                                            {% if role =='commerciale' %}
                                                                <td>
                                                                    {{ user.level }}
                                                                    <span id='affectation ' class="btn-outline-primary">Affectation</span>
                                                                </td>
                                                                <script>i++;</script>
                                                            {% endif %}
                                                            <td>
                                                                {% if(user.Connecte==true) %}
                                                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="{{ asset('dist/img/on.png') }}"></i>
                                                                {% else %}
                                                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img src="{{ asset('dist/img/off.png') }}"></i>
                                                                {% endif %}
                                                            </td>
                                                            <td>
                                                                &nbsp;&nbsp;<a href="{{ path('user_show', {'id': user.id}) }}"><i class="fas fa-eye"></i></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                                                <a href="{{ path('user_edit', {'id': user.id}) }}"><i class="fas fa-edit"></i></a>
                                                            </td>
                                                        </tr>
                                                    {% else %}
                                                        <tr>
                                                            <td colspan="10" style="text-align: center" class="alert-default-warning">Aucun utilisateur trouvé</td>
                                                        </tr>
                                                    {% endfor %}
                                                    </tbody>
                                                    <tfoot>
                                                    <tr>
                                                        <th>&nbsp;&nbsp;ID</th>
                                                        <th>&nbsp;&nbsp;Nom D'utilisateur</th>
                                                        <th>&nbsp;&nbsp;Derniere Visite</th>
                                                        <th>&nbsp;&nbsp;Email</th>
                                                        {% if role =='commerciale' %}
                                                            <th>Affecté a</th>
                                                        {% endif %}
                                                        <th>&nbsp;&nbsp;Connecté(e)</th>
                                                        <th>&nbsp;&nbsp;Voir/Editer</th>
                                                    </tr>
                                                    </tfoot>
                                                </table>
                                                <br>
                                                <a href="{{ path('user_new') }}">Creer utilisateur</a>
                                            </div>                                          </div>

                                    </div>
                                </div>
                                <!-- /.card -->
                            </div>

                            <!-- /.card-body -->
                        </div>
                        <!-- /.card -->
                    </div>
                    <!-- /.col -->
                </div>
                <div class="loading" id="loader" style="display: none">Loading...</div>
                <input type="hidden" value="{{ msg }}" id="msg">
                <!-- /.row -->
            </section>
            <!-- /.content -->
        </div>
        <footer class="main-footer">
            <div class="float-right d-none d-sm-block">
            </div>

        </footer>

        <!-- Control Sidebar -->
        <aside class="control-sidebar control-sidebar-dark">
            <!-- Add Content Here -->
        </aside>
    </div>
    {% block javascripts %}
        <script>
            function app(a){
                $(".affect"+a).hide();
                $(".level"+a).append("<select id='partss"+a+"' class='form-control' required><option value=null>Partenaires</option></select>");
                for (var j=0;j<{{ iii }};j++){
                    var id=$("#id"+j).val();
                    var nom=$("#nom"+j).val();
                    console.log(id+":"+nom)
                    $("#partss"+a).append("<option value='"+id+"'>"+nom+"</option>");
                }
                $("#partss"+a).change(function () {
                    $.ajax({
                        method: "POST",
                        url: "{{ path('user_index') }}",
                        data: {id:  $(this).val(),id1: $("#ids"+a).val()},
                        beforeSend: function() {
                            $("#loader").show()
                        },
                        complete : function() {
                            $("#loader").hide()
                        },
                        success: function(data){
                            $("#ids"+a).append( $(".affect"+a));
                            $(".level"+a).html("");
                            $(".level"+a).append(data);
                            $(".level"+a).append( $(".affect"+a));
                            $(".affect"+a).show();
                            toastr.success('L affectation est bien réussite.');
                        }
                    });
                });
            }

        </script>
        <script>
            $("#affectation").onclick(function () {
                console.log("ok!");
            }) ;
        </script>
        <script src="{{ asset('plugins/jquery/jquery.min.js') }}"></script>
        <!-- Bootstrap 4 -->
        <script src="{{ asset('plugins/bootstrap/js/bootstrap.bundle.min.js') }}"></script>
        <!-- DataTables -->
        <!-- AdminLTE App -->
        <script src="{{ asset('plugins/datatables/jquery.dataTables.js') }}"></script>
        <!-- AdminLTE for demo purposes -->
        <script src="{{ asset('plugins/datatables-bs4/js/dataTables.bootstrap4.js') }}"></script>
        <!-- page script -->
        <script src="{{ asset('dist/js/adminlte.min.js') }}"></script>
        <script src="{{ asset('plugins/sweetalert2/sweetalert2.min.js') }}"></script>
        <script src="{{ asset('plugins/toastr/toastr.min.js') }}"></script>
        <script src="{{ asset('dist/js/demo.js') }}"></script>
        <script src="{{ asset('plugins/sweetalert2/sweetalert2.min.js') }}"></script>
        <script src="{{ asset('plugins/toastr/toastr.min.js') }}"></script>
        <script>
            if ($('#msg').val()==="okk")
            {
                toastr.success('Succès.');
            }
        </script>
        <script>
            $(function () {
                $("#example1").DataTable();
                $('#example2').DataTable({
                    "paging": true,
                    "lengthChange": false,
                    "searching": false,
                    "ordering": true,
                    "info": true,
                    "autoWidth": false,
                });
            });
            $(function () {
                $("#example11").DataTable();
                $('#example2').DataTable({
                    "paging": true,
                    "lengthChange": false,
                    "searching": false,
                    "ordering": true,
                    "info": true,
                    "autoWidth": false,
                });
            });
            $(function () {
                $("#example12").DataTable();
                $('#example2').DataTable({
                    "paging": true,
                    "lengthChange": false,
                    "searching": false,
                    "ordering": true,
                    "info": true,
                    "autoWidth": false,
                });
            });

        </script>
        <script>
            $(function () {
                $("#example9").DataTable();
                $('#example2').DataTable({
                    "paging": true,
                    "lengthChange": false,
                    "searching": false,
                    "ordering": true,
                    "info": true,
                    "autoWidth": false,
                });
            });

        </script>

    {% endblock %}
{% endblock %}
